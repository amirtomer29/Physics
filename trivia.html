<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Master Trivia</title>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --bg-color: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.85); /* קצת יותר כהה לקריאות */
            --accent: #8b5cf6;
            --accent-glow: rgba(139, 92, 246, 0.5);
            --correct: #10b981;
            --wrong: #ef4444;
            --text-main: #f8fafc;
            --text-sec: #94a3b8;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: radial-gradient(circle at top left, #1e1b4b, var(--bg-color));
            color: var(--text-main);
            margin: 0;
            height: 100vh; /* גובה מלא */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* הרקע לא נגלל */
            user-select: none;
        }

        /* רקע דינמי */
        #particles {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* הכרטיס הראשי - התיקון הגדול */
        .quiz-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            width: 90%;
            max-width: 800px; /* רחב יותר למסכים גדולים */
            
            /* ניהול גובה חכם */
            max-height: 90vh; /* לא יעבור 90% מגובה המסך */
            overflow-y: auto; /* גלילה פנימית אם צריך */
            
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            padding: 30px;
            box-sizing: border-box; /* חשוב לחישובי רוחב */
            
            /* אנימציית כניסה */
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.5s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; transform: translateY(0); }
        }

        /* עיצוב פס הגלילה (Scrollbar) */
        .quiz-card::-webkit-scrollbar { width: 8px; }
        .quiz-card::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); border-radius: 4px; }
        .quiz-card::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
        .quiz-card::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.3); }

        /* כותרת */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 15px;
            position: sticky; /* נדבק למעלה בגלילה */
            top: -30px; /* קיזוז הפאדינג */
            background: var(--card-bg); /* כדי שלא יראו טקסט מאחוריו */
            z-index: 10;
            padding-top: 10px;
            margin-top: -10px;
        }

        .badge {
            background: rgba(255,255,255,0.1);
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .question-area h2 {
            font-size: 1.5rem;
            line-height: 1.5;
            margin-bottom: 25px;
            color: #fff;
            text-align: center;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            color: var(--text-sec);
            font-size: 1.05rem;
            cursor: pointer;
            transition: 0.2s all;
            text-align: right;
            position: relative;
            line-height: 1.4;
        }

        .option-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .option-btn.correct { background: rgba(16, 185, 129, 0.2) !important; border-color: var(--correct) !important; color: #fff !important; }
        .option-btn.wrong { background: rgba(239, 68, 68, 0.2) !important; border-color: var(--wrong) !important; color: #fff !important; }

        .feedback-section {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            border-right: 4px solid var(--accent);
            display: none;
            animation: slideDown 0.4s ease-out;
        }

        .feedback-title { font-weight: bold; margin-bottom: 10px; display: block; font-size: 1.1rem; }

        .next-btn {
            width: 100%;
            margin-top: 25px;
            padding: 15px;
            background: linear-gradient(90deg, var(--accent), #7c3aed);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--accent-glow);
            display: none;
        }
        .next-btn:hover { filter: brightness(1.2); transform: scale(1.01); }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* התאמה למובייל ולמסכים צרים */
        @media (max-width: 700px) {
            .options-grid { grid-template-columns: 1fr; }
            .quiz-card { width: 95%; padding: 20px; max-height: 95vh; }
            .question-area h2 { font-size: 1.2rem; }
            .header { top: -20px; } /* התאמה ל-sticky במובייל */
        }

        .finish-screen { text-align: center; display: none; }
        .score-big { font-size: 5rem; font-weight: bold; background: -webkit-linear-gradient(#fff, var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 20px 0; }
    </style>
</head>
<body>

    <canvas id="particles"></canvas>

    <div class="quiz-card" id="quiz-container">
        <div class="header">
            <div class="badge">שאלה <span id="q-curr">1</span> / <span id="q-total">10</span></div>
            <div class="badge">🏆 ניקוד: <span id="score">0</span></div>
        </div>

        <div class="question-area">
            <h2 id="question-text">טוען שאלה...</h2>
        </div>

        <div class="options-grid" id="options-container">
            </div>

        <div class="feedback-section" id="feedback">
            <span class="feedback-title" id="fb-title"></span>
            <p id="fb-text" style="margin:0; line-height:1.6; color:#ccc;"></p>
        </div>

        <button class="next-btn" id="next-btn" onclick="nextQuestion()">המשך לשאלה הבאה ➜</button>
    </div>

    <div class="quiz-card finish-screen" id="finish-card">
        <h1>המשחק נגמר!</h1>
        <div class="score-big" id="final-score">0</div>
        <p style="font-size:1.2rem; color:#aaa;">מתוך <span id="max-score">100</span> נקודות אפשריות</p>
        <p id="finish-msg" style="margin-top:20px;">כל הכבוד!</p>
        <button class="next-btn" style="display:block; margin-top:30px;" onclick="location.reload()">🔄 שחק שוב</button>
    </div>

<script>
    // --- מאגר השאלות ---
    // אפשר להוסיף כאן עוד שאלות בקלות. שים לב לשימוש ב-Latex בין דולרים $$
   const questions = [
    // --- מתמטיקה וזהויות (הבסיס לפיזיקה) ---
    {
        q: "איזו זהות טריגונומטרית משמשת לחיבור שני גלים קוהרנטיים (סופרפוזיציה)?",
        options: [
            "$$ \\sin^2 \\alpha + \\cos^2 \\alpha = 1 $$",
            "$$ \\cos \\alpha + \\cos \\beta = 2 \\cos \\frac{\\alpha+\\beta}{2} \\cos \\frac{\\alpha-\\beta}{2} $$",
            "$$ \\sin(2\\alpha) = 2\\sin\\alpha\\cos\\alpha $$",
            "$$ e^{i\\pi} + 1 = 0 $$"
        ],
        correct: 1,
        explanation: "זהות זו מאפשרת לחבר שני גלים $$ E_1 = E_0 \\cos(\\omega t) $$ ו-$$ E_2 = E_0 \\cos(\\omega t + \\phi) $$ ולקבל ביטוי של גל אחד עם משרעת המושפעת מההפרש הפאזה (הקוסינוס השני)."
    },
    {
        q: "מהי נוסחת אוילר (Euler), המקשרת בין הצגה קרטזית להצגה פולארית של מספר מרוכב (פאזור)?",
        options: [
            "$$ e^{ix} = \\cos x + i \\sin x $$",
            "$$ e^{x} = \\sinh x + \\cosh x $$",
            "$$ a^2 + b^2 = c^2 $$",
            "$$ \\ln(e^x) = x $$"
        ],
        correct: 0,
        explanation: "זו הנוסחה היסודית ביותר בגלים, המאפשרת לנו לעבוד עם פאזורים $$ A e^{i\\phi} $$ במקום עם סינוסים וקוסינוסים מסורבלים."
    },
    {
        q: "כיצד מחשבים את העוצמה (Intensity) מתוך המשרעת המרוכבת $$ \\tilde{E} $$?",
        options: [
            "$$ I = \\text{Re}(\\tilde{E}) $$",
            "$$ I = |\\tilde{E}|^2 = \\tilde{E} \\cdot \\tilde{E}^* $$",
            "$$ I = \\frac{d\\tilde{E}}{dt} $$",
            "$$ I = \\int \\tilde{E} dt $$"
        ],
        correct: 1,
        explanation: "העוצמה פרופורציונלית לריבוע המשרעת. במספרים מרוכבים, הכפל בצמוד ($$ \\tilde{E}^* $$) מבטיח שנקבל תוצאה ממשית וחיובית המייצגת אנרגיה."
    },
    {
        q: "מהי הזהות עבור $$ \\cos(\\alpha \\pm \\beta) $$?",
        options: [
            "$$ \\cos \\alpha \\cos \\beta \\mp \\sin \\alpha \\sin \\beta $$",
            "$$ \\sin \\alpha \\cos \\beta \\pm \\cos \\alpha \\sin \\beta $$",
            "$$ \\cos^2 \\alpha - \\sin^2 \\beta $$",
            "$$ 2 \\cos \\alpha $$"
        ],
        correct: 0,
        explanation: "זהות זו חיונית לפיתוח משוואת הגלים ועבודה עם גלים נעים."
    },

    // --- יסודות הגלים ---
    {
        q: "מהו מספר הגל ($$ k $$) ומה הקשר שלו לאורך הגל?",
        options: [
            "$$ k = \\lambda / 2\\pi $$",
            "$$ k = 2\\pi \\lambda $$",
            "$$ k = 2\\pi / \\lambda $$",
            "$$ k = 1 / \\lambda $$"
        ],
        correct: 2,
        explanation: "$$ k $$ מייצג את מספר המחזורים (ברדיאנים) ליחידת מרחק. הוא המקביל המרחבי לתדירות הזוויתית $$ \\omega $$."
    },
    {
        q: "מהירות הפאזה $$ v_p $$ של גל מוגדרת כ:",
        options: [
            "$$ v_p = \\frac{d\\omega}{dk} $$",
            "$$ v_p = \\frac{\\omega}{k} $$",
            "$$ v_p = c $$",
            "$$ v_p = \\lambda f^2 $$"
        ],
        correct: 1,
        explanation: "מהירות הפאזה היא המהירות שבה מתקדמת נקודה בעלת פאזה קבועה (למשל השיא של הגל)."
    },
    {
        q: "מהו התנאי לכך שמהירות החבורה $$ v_g $$ תהיה שווה למהירות הפאזה $$ v_p $$?",
        options: [
            "תמיד נכון",
            "כאשר התווך הוא דיספרסיבי (נפיץ)",
            "כאשר התווך אינו דיספרסיבי (מקדם השבירה לא תלוי בתדר)",
            "רק בריק"
        ],
        correct: 2,
        explanation: "אם $$ n $$ קבוע ואינו תלוי ב-$$ \\omega $$, היחס $$ \\omega/k $$ קבוע ולכן הנגזרת שווה לערך הפונקציה."
    },

    // --- משוואות יסוד (Helmholtz & Eikonal) ---
    {
        q: "מהי משוואת הלמהולץ (Helmholtz) במרחב?",
        options: [
            "$$ (\\nabla^2 + k^2) U(\\vec{r}) = 0 $$",
            "$$ \\nabla^2 V = -\\frac{\\rho}{\\epsilon_0} $$",
            "$$ \\frac{\\partial U}{\\partial t} = D \\nabla^2 U $$",
            "$$ F = ma $$"
        ],
        correct: 0,
        explanation: "זוהי משוואת הגלים הבלתי-תלויה בזמן, המתקבלת לאחר הפרדת משתנים והנחת פתרון הרמוני בזמן."
    },
    {
        q: "מה מתארת משוואת האיקונל $$ |\\nabla S|^2 = n^2 $$?",
        options: [
            "את התפלגות העוצמה באופטיקה פיזיקלית",
            "את חזיתות הגל בקירוב האופטיקה הגיאומטרית ($$ \\lambda \\to 0 $$)",
            "את הקיטוב של האור",
            "את עקרון אי-הודאות"
        ],
        correct: 1,
        explanation: "הפונקציה $$ S $$ היא ה'פעולה' האופטית. הנורמל למשטחי $$ S=const $$ נותן את כיוון הקרניים הגיאומטריות."
    },

    // --- התאבכות ושכבות דקות ---
    {
        q: "מהו התנאי להתאבכות **הורסת** בשכבה דקה (באוויר) בעובי $$ d $$ ומקדם שבירה $$ n $$?",
        options: [
            "$$ 2nd = m\\lambda $$",
            "$$ 2nd = (m + \\frac{1}{2})\\lambda $$",
            "$$ d \\sin \\theta = m\\lambda $$",
            "$$ nd = m\\lambda $$"
        ],
        correct: 0,
        explanation: "שים לב! בהחזרה מתווך צפוף (מהשכבה העליונה) יש היפוך פאזה ($$ \\lambda/2 $$). לכן התנאי מתהפך: הפרש דרך של כפולה שלמה נותן דווקא מינימום."
    },
    {
        q: "מדוע בועת סבון נראית שחורה רגע לפני שהיא מתפוצצת (כשהעובי שלה שואף לאפס)?",
        options: [
            "כי אין שם סבון בכלל",
            "בגלל התאבכות הורסת בין ההחזרה הקדמית (עם היפוך פאזה) לאחורית (בלי היפוך)",
            "כי כל האור נבלע במים",
            "זו אשליה אופטית"
        ],
        correct: 1,
        explanation: "כאשר $$ d \\to 0 $$, הפרש הדרכים הוא אפס, אך היפוך הפאזה היחיד גורם לגל המוחזר להיות הפוך בסימן לגל הפוגע -> חושך."
    },
    {
        q: "בטבעות ניוטון, מה מייצג הרדיוס $$ r_m $$ של הטבעת הכהה ה-$$ m $$?",
        options: [
            "$$ r_m = \\sqrt{m \\lambda R} $$",
            "$$ r_m = m \\lambda / R $$",
            "$$ r_m = \\sqrt{R / m \\lambda} $$",
            "$$ r_m = m^2 R $$"
        ],
        correct: 0,
        explanation: "זהו הקירוב עבור עדשה בעלת רדיוס עקמומיות $$ R $$ גדול מאוד ביחס לאורך הגל."
    },

    // --- עקיפה (Diffraction) ---
    {
        q: "במעבר דרך סדק יחיד ברוחב $$ a $$, היכן מופיע המינימום הראשון?",
        options: [
            "$$ \\sin \\theta = \\lambda / a $$",
            "$$ \\sin \\theta = \\lambda / 2a $$",
            "$$ \\sin \\theta = 1.22 \\lambda / a $$",
            "$$ \\sin \\theta = 0 $$"
        ],
        correct: 0,
        explanation: "תנאי המינימום בסדק יחיד הוא $$ a \\sin \\theta = m \\lambda $$ (עבור $$ m=1 $$). שים לב שזה הפוך מסדקים של יאנג!"
    },
    {
        q: "מה קובע קריטריון ריילי (Rayleigh) לרזולוציה אופטית?",
        options: [
            "שני מקורות ניתנים להפרדה אם המקסימום של אחד נופל על המינימום הראשון של השני",
            "שני מקורות ניתנים להפרדה רק אם הם בצבעים שונים",
            "הרזולוציה היא אינסופית עבור עדשה מושלמת",
            "זווית ההפרדה היא $$ \\theta = \\lambda / D $$ בדיוק"
        ],
        correct: 0,
        explanation: "הזווית המינימלית להפרדה היא $$ \\theta \\approx 1.22 \\lambda / D $$ עבור מפתח עגול."
    },

    // --- קיטוב (Polarization) ---
    {
        q: "כיצד מיוצג קיטוב מעגלי ימני (RCP) באמצעות וקטור ג'ונס?",
        options: [
            "$$ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$",
            "$$ \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ i \\end{pmatrix} $$",
            "$$ \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -i \\end{pmatrix} $$",
            "$$ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$"
        ],
        correct: 2,
        explanation: "ה-$$ -i $$ מציין פיגור פאזה של 90 מעלות ($$ \\pi/2 $$) לרכיב ה-y."
    },
    {
        q: "מהי זווית ברוסטר (Brewster)?",
        options: [
            "זווית שבה יש החזרה מלאה פנימית",
            "זווית שבה האור המוחזר מקוטב ליניארית במלואו (רכיב TM לא מוחזר)",
            "זווית השבירה במים",
            "הזווית שבה העקיפה היא מקסימלית"
        ],
        correct: 1,
        explanation: "בזווית זו, $$ \\tan \\theta_B = n_2/n_1 $$, הדיפולים בחומר מתנודדים במקביל לכיוון ההחזרה ולכן לא יכולים לפלוט קרינה לכיוון זה."
    },
    {
        q: "לוח 'חצי גל' (Half-Wave Plate) משמש ל:",
        options: [
            "הפיכת אור ליניארי למעגלי",
            "חסימת האור לחלוטין",
            "סיבוב מישור הקיטוב הליניארי",
            "הפחתת העוצמה בחצי"
        ],
        correct: 2,
        explanation: "הלוח יוצר הפרש פאזה של $$ \\pi $$, מה שמשקף את וקטור הקיטוב סביב הציר המהיר של הגביש."
    },
    {
        q: "לוח 'רבע גל' (Quarter-Wave Plate) משמש ל:",
        options: [
            "הפיכת אור ליניארי למעגלי (ולהפך)",
            "סיבוב הקיטוב ב-90 מעלות",
            "יצירת לייזרים",
            "ביטול השתקפויות"
        ],
        correct: 0,
        explanation: "הוא יוצר הפרש פאזה של $$ \\pi/2 $$ בין הרכיבים, שזה בדיוק מה שנדרש כדי לעבור מפאזה זהה (ליניארי) להפרש 90 מעלות (מעגלי)."
    },

    // --- אפקטים מתקדמים ואלקטרו-אופטיקה ---
    {
        q: "מהו אפקט פוקלס (Pockels)?",
        options: [
            "שינוי מקדם השבירה כתלות ליניארית בשדה חשמלי חיצוני",
            "שינוי מקדם השבירה כתלות בריבוע השדה החשמלי (Kerr)",
            "פליטת אלקטרונים כתוצאה מפגיעת אור",
            "פיזור אור מחלקיקים קטנים"
        ],
        correct: 0,
        explanation: "זהו אפקט אלקטרו-אופטי ליניארי, המאפשר בניית מאפננים (Modulators) מהירים מאוד לתקשורת אופטית."
    },
    {
        q: "מהי נפיצה אנומלית (Anomalous Dispersion)?",
        options: [
            "כאשר מקדם השבירה עולה עם התדר",
            "כאשר מקדם השבירה יורד עם התדר (קורה בקרבת קווי בליעה)",
            "כאשר האור נע לאחור",
            "כאשר האור משנה צבע"
        ],
        correct: 1,
        explanation: "בדרך כלל $$ n $$ עולה עם התדר (נפיצה נורמלית, כמו בזכוכית). ליד תדר רזוננס של החומר, המגמה מתהפכת."
    },
    {
        q: "וקטור פוינטינג ($$ \\vec{S} $$) מייצג את:",
        options: [
            "כיוון השדה החשמלי",
            "שטף האנרגיה ליחידת שטח ליחידת זמן",
            "התנע הזוויתי של הפוטון",
            "הכוח המגנטי"
        ],
        correct: 1,
        explanation: "$$ \\vec{S} = \\frac{1}{\\mu_0} \\vec{E} \\times \\vec{B} $$. כיוונו הוא כיוון התקדמות האנרגיה."
    },
    
    // --- שאלות אתגר נוספות ---
    {
        q: "מהי הקוהרנטיות הזמנית (Temporal Coherence)?",
        options: [
            "היכולת של גל להתאבך עם עצמו לאחר זמן $$ \\Delta t $$",
            "רוחב האלומה במרחב",
            "הזמן שלוקח ללייזר להידלק",
            "מידת הקיטוב של האור"
        ],
        correct: 0,
        explanation: "היא קשורה ישירות לרוחב הפס הספקטרלי של המקור. אור מונוכרומטי מושלם הוא בעל קוהרנטיות זמנית אינסופית."
    },
    {
        q: "מה קורה למהירות האור בחומר ($$ v $$) ככל שמקדם השבירה ($$ n $$) גדל?",
        options: [
            "המהירות גדלה",
            "המהירות קטנה",
            "המהירות לא משתנה",
            "תלוי בקיטוב בלבד"
        ],
        correct: 1,
        explanation: "לפי ההגדרה $$ n = c/v $$, ככל ש-$$ n $$ גדול יותר, המהירות $$ v $$ בחומר נמוכה יותר."
    },
    {
        q: "חוק סנל ניתן לפיתוח מתוך עקרון:",
        options: [
            "עקרון פרמה (Fermat) - זמן המינימום",
            "חוק שימור האנרגיה בלבד",
            "חוק גאוס",
            "עקרון האי-ודאות"
        ],
        correct: 0,
        explanation: "עקרון פרמה קובע שהאור ינוע במסלול הדורש את הזמן הקצר ביותר (או ליתר דיוק, סטציונרי)."
    },
    {
        q: "איזה גודל נשמר תמיד במעבר ליניארי בין תווכים?",
        options: [
            "אורך הגל $$ \\lambda $$",
            "התדר $$ f $$ (או $$ \\omega $$)",
            "המהירות $$ v $$",
            "המשרעת $$ E_0 $$"
        ],
        correct: 1,
        explanation: "התדר מוכתב על ידי המקור ולא משתנה במעבר בין תווכים פסיביים. כל השאר (אורך גל, מהירות, משרעת) משתנים."
    },
    {
        q: "בסיב אופטי, התקדמות האור מבוססת על:",
        options: [
            "החזרה גמורה פנימית (Total Internal Reflection)",
            "ציפוי מראות מתכתי",
            "אפקט פוטואלקטרי",
            "פיזור ריילי"
        ],
        correct: 0,
        explanation: "כאשר האור פוגע בזווית שטוחה מספיק במעטפת בעלת מקדם שבירה נמוך יותר, הוא מוחזר במלואו פנימה."
    },
    {
        q: "מהו ההבדל המרכזי בין עקיפת פרנהוף (Fraunhofer) לעקיפת פרנל (Fresnel)?",
        options: [
            "פרנהוף הוא לשדה רחוק (קרניים מקבילות), פרנל לשדה קרוב",
            "פרנהוף עוסק בלייזרים, פרנל בנורות להט",
            "אין הבדל, אלו שמות נרדפים",
            "פרנל הוא הקירוב המדויק יותר למרחקים אינסופיים"
        ],
        correct: 0,
        explanation: "קירוב פרנהוף מניח שהמקור והמסך רחוקים מאוד מהסדק, כך שניתן להתייחס לגלים כמישוריים."
    },
    {
        q: "עבור גל אלקטרומגנטי בריק, השדה החשמלי והמגנטי הם:",
        options: [
            "מקבילים זה לזה",
            "מאונכים זה לזה ומאונכים לכיוון ההתקדמות",
            "בפאזה הפוכה (180 מעלות)",
            "בלתי תלויים"
        ],
        correct: 1,
        explanation: "גל EM הוא גל רוחבי (TEM), כאשר $$ \\vec{E} \\perp \\vec{B} \\perp \\vec{k} $$."
    },
    {
        q: "איזה רכיב אופטי מפצל אלומת אור לשתי אלומות נפרדות?",
        options: [
            "מפצל קרן (Beam Splitter)",
            "מראה קעורה",
            "עדשה מרכזת",
            "מסנן צבע"
        ],
        correct: 0,
        explanation: "זהו הרכיב המרכזי באינטרפרומטרים (כמו מייקלסון), המאפשר פיצול משרעת."
    },
    // --- אופטיקה גיאומטרית ומשוואות יסוד ---
    {
        q: "באיזה גבול הופכת משוואת הגלים למשוואת האיקונל (Eikonal)?",
        options: [
            "$$ \\lambda \\to \\infty $$ (אורך גל אינסופי)",
            "$$ \\lambda \\to 0 $$ (אורך גל שואף לאפס)",
            "$$ v \\to c $$ (מהירות האור)",
            "$$ \\omega \\to 0 $$ (תדר אפס)"
        ],
        correct: 1,
        explanation: "משוואת האיקונל מתארת את האופטיקה הגיאומטרית, שהיא הקירוב המתקבל כאשר אורך הגל קטן מאוד ביחס לעצמים במערכת ($$ \\lambda \\to 0 $$)."
    },
    {
        q: "מה מתארת הפונקציה $$ S(\\vec{r}) $$ במשוואת האיקונל $$ |\\nabla S|^2 = n^2 $$?",
        options: [
            "את עוצמת האור",
            "את הפאזה האופטית (Eikonal), שמשטחי השווה שלה הם חזיתות הגל",
            "את הקיטוב של הגל",
            "את מהירות החבורה"
        ],
        correct: 1,
        explanation: "הגרדיאנט של $$ S $$ ($$ \\nabla S $$) מצביע על כיוון התקדמות הקרניים (הניצב לחזית הגל)."
    },
    {
        q: "משוואת הלמהולץ $$ (\\nabla^2 + k^2)U = 0 $$ מתקבלת ממשוואת הגלים כאשר:",
        options: [
            "מניחים שהגל הוא מונוכרומטי (תלות הרמונית בזמן $$ e^{-i\\omega t} $$)",
            "מניחים שהמהירות היא אינסופית",
            "מניחים שאין מקורות במרחב",
            "מזניחים את הנגזרת המרחבית"
        ],
        correct: 0,
        explanation: "כאשר מפרידים משתנים ומניחים תלות בזמן של $$ e^{-i\\omega t} $$, הנגזרת הזמנית השנייה הופכת לכפל ב-$$ -\\omega^2 $$, וכך מקבלים את $$ k^2 $$."
    },

    // --- נפיצה (Dispersion) ומהירויות ---
    {
        q: "מהי מהירות החבורה (Group Velocity) $$ v_g $$?",
        options: [
            "$$ v_g = \\frac{\\omega}{k} $$",
            "$$ v_g = \\frac{d\\omega}{dk} $$",
            "$$ v_g = \\frac{dk}{d\\omega} $$",
            "$$ v_g = c $$"
        ],
        correct: 1,
        explanation: "מהירות החבורה היא המהירות שבה מתקדמת המעטפת (האנרגיה) של חבילת גלים."
    },
    {
        q: "מה מאפיין תווך עם נפיצה נורמלית (Normal Dispersion)?",
        options: [
            "מקדם השבירה עולה עם התדר ($$ dn/d\\omega > 0 $$), ומהירות החבורה קטנה ממהירות הפאזה",
            "מקדם השבירה יורד עם התדר",
            "מהירות החבורה גדולה ממהירות הפאזה",
            "כל הצבעים נעים באותה מהירות"
        ],
        correct: 0,
        explanation: "ברוב החומרים השקופים (כמו זכוכית), התדרים הגבוהים (כחול) נשברים חזק יותר מהנמוכים (אדום), ומהירות החבורה נמוכה ממהירות הפאזה."
    },
    {
        q: "מהו אות 'מצויץ' (Chirped Pulse)?",
        options: [
            "אות שהמשרעת שלו קבועה תמיד",
            "אות שהתדר הרגעי שלו משתנה כתלות בזמן ($$ \\omega(t) $$)",
            "אות שעבר קיטוב מעגלי",
            "אות שעובר בריק בלבד"
        ],
        correct: 1,
        explanation: "ב-Chirp, התדר אינו קבוע לאורך הפולס. למשל, בציוץ חיובי (Up-chirp) התדר עולה מתחילת הפולס ועד סופו."
    },
    {
        q: "אם יחס הנפיצה הוא ליניארי ($$ \\omega = c k $$), אז:",
        options: [
            "יש נפיצה חזקה מאוד",
            "אין נפיצה כלל, ו-$$ v_g = v_p $$",
            "הגל לא מתקדם",
            "מהירות החבורה היא אפס"
        ],
        correct: 1,
        explanation: "זהו המצב בריק (Vacuum). כל התדרים נעים באותה מהירות, והצורה של חבילת הגלים לא נמרחת עם הזמן."
    },

    // --- התאבכות, פאזורים וזהויות ---
    {
        q: "איזו זהות טריגונומטרית מאפשרת לחשב סופרפוזיציה של $$ A\\cos(\\omega t) + A\\cos(\\omega t + \\phi) $$?",
        options: [
            "$$ \\cos u + \\cos v = 2 \\cos(\\frac{u+v}{2}) \\cos(\\frac{u-v}{2}) $$",
            "$$ \\sin^2 u + \\cos^2 u = 1 $$",
            "$$ \\cos(u+v) = \\cos u \\cos v - \\sin u \\sin v $$",
            "$$ \\tan u = \\sin u / \\cos u $$"
        ],
        correct: 0,
        explanation: "זהות זו הופכת סכום למכפלה, ומבודדת את האיבר התלוי בזמן (התדר) מהאיבר התלוי בהפרש הפאזה (המשרעת השקולה)."
    },
    {
        q: "בשיטת הפאזורים, חיבור שני גלים קוהרנטיים שקול ל:",
        options: [
            "חיבור אלגברי של העוצמות",
            "חיבור וקטורי של המשרעות המרוכבות במישור המרוכב",
            "כפל של התדרים",
            "חיסור של אורכי הגל"
        ],
        correct: 1,
        explanation: "משרעת הגל השקול היא הסכום הווקטורי (ראש לזנב) של החצים המסתובבים (הפאזורים)."
    },
    {
        q: "בטבעות ניוטון (עדשה על משטח ישר), מדוע מרכז התבנית חשוך?",
        options: [
            "בגלל עובי העדשה",
            "בגלל החזרה גמורה פנימית",
            "בגלל היפוך פאזה ($$ \\pi $$) בהחזרה אחת בלבד (מהמשטח התחתון)",
            "כי אין שם אור בכלל"
        ],
        correct: 2,
        explanation: "בנקודת המגע ($$ d \\to 0 $$), הפרש הדרכים הוא אפס, אך יש היפוך פאזה בהחזרה מהתווך הצפוף (הזכוכית התחתונה), מה שיוצר התאבכות הורסת."
    },
    {
        q: "מהו התנאי להתאבכות **בונה** בשכבת שמן (מקדם $$ n $$) הצפה על מים, כאשר $$ n_{air} < n_{oil} < n_{water} $$?",
        options: [
            "$$ 2nd = m\\lambda $$ (כי יש שני היפוכי פאזה או אפס)",
            "$$ 2nd = (m+0.5)\\lambda $$ (כי יש היפוך פאזה אחד בלבד)",
            "$$ d = m\\lambda $$",
            "תלוי בעובי המים מתחת"
        ],
        correct: 0,
        explanation: "שים לב! כאן יש היפוך פאזה גם בכניסה לשמן (אוויר->שמן) וגם בהחזרה מהמים (שמן->מים). שני היפוכים מבטלים זה את זה, ולכן התנאי חוזר להיות רגיל."
    },

    // --- אלקטרו-אופטיקה (Pockels) ---
    {
        q: "מהו אפקט פוקלס (Pockels Effect)?",
        options: [
            "שינוי מקדם השבירה ביחס ריבועי לשדה החשמלי",
            "שינוי מקדם השבירה ביחס ליניארי לשדה החשמלי ($$ \\Delta n \\propto E $$)",
            "פליטת אור כתוצאה מזרם חשמלי",
            "שינוי קיטוב כתוצאה משדה מגנטי"
        ],
        correct: 1,
        explanation: "אפקט פוקלס הוא אפקט אלקטרו-אופטי ליניארי, המתרחש רק בחומרים ללא סימטריה ליפוך (Non-centrosymmetric)."
    },
    {
        q: "מהו שימוש נפוץ בתא פוקלס (Pockels Cell)?",
        options: [
            "הגברת אור",
            "אפנון (Modulation) של פאזה או קיטוב במהירות גבוהה",
            "יצירת חשמל מאור",
            "קירור לייזרים"
        ],
        correct: 1,
        explanation: "בגלל התגובה המהירה לשדה החשמלי, משתמשים בו כ'מפסק' מהיר ללייזרים (Q-switching) או למודולציה של מידע."
    },
    {
        q: "מתח 'חצי-גל' ($$ V_\\pi $$) באפנן פוקלס הוא:",
        options: [
            "המתח הדרוש כדי לעצור את האור",
            "המתח הדרוש ליצירת הפרש פאזה של $$ \\pi $$ בין שני רכיבי הקיטוב",
            "חצי מהמתח המקסימלי האפשרי",
            "המתח שבו הגביש נשבר"
        ],
        correct: 1,
        explanation: "זהו פרמטר קריטי - המתח שבו הקיטוב משתנה, למשל מליניארי למעגלי (בקונפיגורציה מסוימת) או גורם להתאבכות הורסת ביציאה."
    },

    // --- עקיפה ופורייה ---
    {
        q: "עקיפת פרנהוף (Fraunhofer) מתארת את שדה הגל כאשר:",
        options: [
            "המרחק מהסדק הוא אינסופי (או במוקד עדשה)",
            "המרחק מהסדק קצר מאוד (שדה קרוב)",
            "רוחב הסדק גדול מאורך הגל",
            "אין סדק בכלל"
        ],
        correct: 0,
        explanation: "זהו הגבול שבו קרניים המגיעות מנקודות שונות בסדק הן מקבילות בקירוב. מתמטית, זה שקול לטרנספורם פורייה של מפתח הסדק."
    },
    {
        q: "מה הקשר בין רוחב הסדק $$ a $$ לרוחב תבנית העקיפה המרכזית $$ W $$ (על מסך רחוק)?",
        options: [
            "ככל שהסדק רחב יותר ($$ a $$ גדל), התבנית רחבה יותר",
            "ככל שהסדק צר יותר ($$ a $$ קטן), התבנית רחבה יותר",
            "אין קשר בין השניים",
            "התבנית תמיד ברוחב $$ \\lambda $$"
        ],
        correct: 1,
        explanation: "זו תכונה של טרנספורם פורייה (עקרון אי-הודאות): הצרת הפונקציה במרחב (סדק צר) גורמת להרחבתה בתדר המרחבי (תבנית רחבה)."
    },
    {
        q: "בניתוח פורייה, פולס צר מאוד בזמן דורש:",
        options: [
            "רוחב פס צר מאוד בתדר",
            "רוחב פס רחב מאוד בתדר (הרבה תדרים)",
            "תדר יחיד בלבד",
            "משרעת אינסופית"
        ],
        correct: 1,
        explanation: "כדי ליצור 'שפיץ' חד בזמן (כמו פונקציית דלתא), צריך לחבר גלים בעלי טווח תדרים אינסופי."
    },

    // --- קיטוב (מתקדם) ---
    {
        q: "וקטור ג'ונס $$ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$ מתאר:",
        options: [
            "קיטוב ליניארי אופקי (ציר x)",
            "קיטוב ליניארי אנכי (ציר y)",
            "קיטוב מעגלי ימני",
            "אור לא מקוטב"
        ],
        correct: 0,
        explanation: "הרכיב העליון מייצג את המשרעת בציר x והתחתון בציר y."
    },
    {
        q: "וקטור ג'ונס $$ \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix} $$ מתאר:",
        options: [
            "קיטוב ליניארי ב-45 מעלות",
            "קיטוב מעגלי שמאלי (LCP)",
            "קיטוב מעגלי ימני (RCP) - תלוי בהגדרה, אך בהחלט מעגלי",
            "קיטוב אליפטי כללי"
        ],
        correct: 2,
        explanation: "ה-$$ i $$ מציין הפרש פאזה של 90 מעלות בין הרכיבים, כאשר האמפליטודות שוות. זהו התנאי לקיטוב מעגלי."
    },
    {
        q: "אם מעבירים אור דרך מקטב ואחריו דרך מקטב שני המאונך לו (90 מעלות), העוצמה ביציאה תהיה:",
        options: [
            "מקסימלית",
            "50% מהעוצמה",
            "אפס (חושך מוחלט)",
            "תלויה בצבע האור"
        ],
        correct: 2,
        explanation: "המקטב הראשון חוסם הכל חוץ מציר אחד. המקטב השני חוסם בדיוק את הציר הזה. $$ \\cos(90^\\circ) = 0 $$."
    },

    // --- כללי גלים ומתמטיקה ---
    {
        q: "מה מייצג המספר $$ k $$ בביטוי $$ e^{ikx} $$?",
        options: [
            "את התדר הזמני",
            "את מספר הגל (תדר מרחבי), המגדיר כמה מחזורים נכנסים ביחידת מרחק",
            "את קבוע הקפיץ",
            "את מקדם השבירה"
        ],
        correct: 1,
        explanation: "$$ k = 2\\pi / \\lambda $$. הוא המקביל המרחבי ל-$$ \\omega $$ הזמני."
    },
    {
        q: "מהירות הפאזה בריק היא $$ c $$. מהו הקשר בין $$ \\omega $$ ל-$$ k $$ בריק?",
        options: [
            "$$ \\omega = c k $$ (יחס ליניארי)",
            "$$ \\omega = c k^2 $$",
            "$$ \\omega = \\sqrt{k} $$",
            "אין קשר ביניהם"
        ],
        correct: 0,
        explanation: "בריק אין נפיצה, ולכן היחס הוא ליניארי פשוט."
    },
    {
        q: "מהי המשמעות של הפאזה $$ \\phi $$ בביטוי $$ \\cos(\\omega t + \\phi) $$?",
        options: [
            "הזזה בזמן או במרחב של הגל ביחס לראשית",
            "המהירות של הגל",
            "אורך הגל",
            "האנרגיה של הגל"
        ],
        correct: 0,
        explanation: "הפאזה קובעת את מצב הגל ברגע $$ t=0 $$. שינוי פאזה שקול להזזת הגל ימינה או שמאלה."
    },
    {
        q: "גל מישורי (Plane Wave) מאופיין בכך ש:",
        options: [
            "משטחי שווי-הפאזה שלו הם מישורים אינסופיים הניצבים לכיוון ההתקדמות",
            "הוא מתפשט ככדור מנקודה מרכזית",
            "העוצמה שלו דועכת כמו $$ 1/r^2 $$",
            "הוא קיים רק במים"
        ],
        correct: 0,
        explanation: "מתמטית הוא מתואר כ-$$ e^{i(\\vec{k}\\cdot\\vec{r} - \\omega t)} $$ והוא אידיאליזציה שימושית מאוד בפיזיקה."
    },
    {
        q: "אינטרפרומטר מייקלסון משמש בעיקר ל:",
        options: [
            "מדידת אורכי גל מדויקים או שינויים זעירים במרחק",
            "מדידת מסה של כוכבים",
            "יצירת לייזרים חזקים",
            "ראיית לילה"
        ],
        correct: 0,
        explanation: "על ידי ספירת ה'פסים' (Fringes) שזזים, ניתן למדוד מרחקים ברזולוציה של שברי אורך גל."
    },
    {
        q: "מה קורה לעוצמת האור הממוצעת כאשר מחברים שני גלים עם פאזה אקראית (לא קוהרנטיים)?",
        options: [
            "העוצמות מתחברות ($$ I_{total} = I_1 + I_2 $$)",
            "המשרעות מתחברות ($$ A_{total} = A_1 + A_2 $$)",
            "נוצרת תבנית התאבכות יציבה",
            "העוצמה מתאפסת"
        ],
        correct: 0,
        explanation: "ללא קוהרנטיות, איבר ההתאבכות ($$ 2\\sqrt{I_1 I_2}\\cos\\delta $$) מתמצע לאפס, ונשארים רק עם סכום העוצמות."
    },
    {
        q: "עקיפה (Diffraction) היא תופעה משמעותית בעיקר כאשר:",
        options: [
            "גודל המכשול או הסדק הוא בסדר גודל של אורך הגל",
            "המכשול גדול מאוד ביחס לאורך הגל",
            "האור הוא חלש מאוד",
            "רק בריק מוחלט"
        ],
        correct: 0,
        explanation: "כאשר $$ a \\gg \\lambda $$, אנו בתחום האופטיקה הגיאומטרית והעקיפה זניחה. כאשר $$ a \\approx \\lambda $$, העקיפה דומיננטית."
    },
    {
        q: "מהי המשמעות של $$ |E|^2 $$ בפיזיקה של גלים?",
        options: [
            "האנרגיה או העוצמה של הגל",
            "הכיוון של הגל",
            "המהירות של הגל",
            "התדר של הגל"
        ],
        correct: 0,
        explanation: "המשרעת בריבוע מייצגת את צפיפות האנרגיה או שטף האנרגיה (פרופורציונלית)."
    },
    {
        q: "במעבר אור דרך סדק עגול, התבנית המתקבלת נקראת:",
        options: [
            "דיסקת איירי (Airy Disk)",
            "טבעות ניוטון",
            "פסים של יאנג",
            "סריג עקיפה"
        ],
        correct: 0,
        explanation: "זוהי נקודת אור מרכזית המוקפת בטבעות חלשות, הנוצרת כתוצאה מעקיפה במפתח עגול."
    },
    {
        q: "הזהות $$ e^{i\\pi} + 1 = 0 $$ ידועה כ:",
        options: [
            "זהות אוילר (היפה ביותר במתמטיקה)",
            "חוק סנל",
            "משוואת הגלים",
            "חוק ברוסטר"
        ],
        correct: 0,
        explanation: "היא מקשרת בין חמשת הקבועים החשובים ביותר: $$ e, i, \\pi, 1, 0 $$."
    },
    // ============================================
    // חלק א': משוואת המיתר ופתרון ד'אלמבר
    // ============================================
    {
        q: "מהי משוואת הגלים החד-ממדית (משוואת המיתר) עבור מיתר הומוגני?",
        options: [
            "$$ \\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2} $$",
            "$$ \\frac{\\partial u}{\\partial t} = c^2 \\frac{\\partial^2 u}{\\partial x^2} $$",
            "$$ \\frac{\\partial^2 u}{\\partial t^2} + \\frac{\\partial^2 u}{\\partial x^2} = 0 $$",
            "$$ u_{tt} = -c^2 u_{xx} $$"
        ],
        correct: 0,
        explanation: "זוהי המשוואה הקלאסית המקשרת בין התאוצה של אלמנט מיתר (נגזרת שנייה בזמן) לכוח המחזיר הנובע מהעקמומיות (נגזרת שנייה במקום)."
    },
    {
        q: "מה מייצג הקבוע $$ c $$ במשוואת המיתר $$ T $$ (מתיחות) ו-$$ \\mu $$ (צפיפות אורכית)?",
        options: [
            "$$ c = \\sqrt{T / \\mu} $$",
            "$$ c = T / \\mu $$",
            "$$ c = \\sqrt{\\mu / T} $$",
            "$$ c = \\mu T^2 $$"
        ],
        correct: 0,
        explanation: "מהירות התפשטות הגל במיתר תלויה בשורש היחס בין המתיחות לצפיפות המסה."
    },
    {
        q: "פתרון ד'אלמבר (D'Alembert) למשוואת הגלים הוא מהצורה:",
        options: [
            "$$ u(x,t) = f(x-ct) + g(x+ct) $$",
            "$$ u(x,t) = A \\cos(kx) \\sin(\\omega t) $$",
            "$$ u(x,t) = e^{i(kx-\\omega t)} $$",
            "$$ u(x,t) = f(x)g(t) $$"
        ],
        correct: 0,
        explanation: "זהו הפתרון הכללי ביותר למיתר אינסופי: סכום של שתי הפרעות שרירותיות, אחת נעה ימינה ואחת שמאלה."
    },
    {
        q: "כאשר גל במיתר פוגע בקצה קבוע (Fixed End, תנאי דיריכלה), הגל המוחזר:",
        options: [
            "מתהפך בפאזה ($$ \\pi $$ shift)",
            "חוזר ללא שינוי פאזה",
            "נעלם (נספג)",
            "מכפיל את המשרעת שלו"
        ],
        correct: 0,
        explanation: "כדי לקיים את התנאי שההעתק בקצה הוא תמיד אפס, הגל המוחזר חייב להיות הפוך בסימנו לגל הפוגע."
    },
    {
        q: "מהו תנאי שפה מסוג נוימן (Neumann) עבור מיתר?",
        options: [
            "הקצה חופשי לנוע ($$ \\partial u / \\partial x = 0 $$)",
            "הקצה מקובע ($$ u = 0 $$)",
            "הקצה מחובר לקפיץ",
            "הקצה נע במהירות קבועה"
        ],
        correct: 0,
        explanation: "תנאי נוימן קובע את הנגזרת (השיפוע). במיתר, שיפוע אפס בקצה אומר שאין כוח אנכי הפועל עליו, כלומר טבעת חסרת חיכוך על מוט."
    },
    {
        q: "מהי התדירות היסודית ($$ f_1 $$) של מיתר באורך $$ L $$ המקובע בשני קצותיו?",
        options: [
            "$$ f_1 = \\frac{c}{2L} $$",
            "$$ f_1 = \\frac{c}{L} $$",
            "$$ f_1 = \\frac{2c}{L} $$",
            "$$ f_1 = \\frac{c}{4L} $$"
        ],
        correct: 0,
        explanation: "אורך הגל הארוך ביותר האפשרי הוא $$ \\lambda = 2L $$ (חצי גל נכנס במיתר). מכיוון ש-$$ f = c/\\lambda $$, נקבל $$ c/2L $$."
    },
    {
        q: "אנרגיה של מיתר רוטט תלויה בריבוע המשרעת וב:",
        options: [
            "ריבוע התדר ($$ \\omega^2 $$)",
            "התדר ($$ \\omega $$)",
            "שורש התדר",
            "אינה תלויה בתדר"
        ],
        correct: 0,
        explanation: "האנרגיה הכוללת (קינטית + פוטנציאלית) פרופורציונלית ל-$$ A^2 \\omega^2 $$."
    },

    // ============================================
    // חלק ב': טורי פורייה (Fourier Series)
    // ============================================
    {
        q: "טור פורייה מאפשר להציג כל פונקציה מחזורית כ:",
        options: [
            "סכום אינסופי של סינוסים וקוסינוסים",
            "סכום של פולינומים (חזקות של x)",
            "מכפלה של אקספוננטים",
            "סכום של נגזרות"
        ],
        correct: 0,
        explanation: "זהו הרעיון המרכזי: פירוק אות מחזורי לרכיבים הרמוניים פשוטים."
    },
    {
        q: "עבור פונקציה אי-זוגית ($$ f(-x) = -f(x) $$), טור פורייה יכיל:",
        options: [
            "רק איברי סינוס ($$ b_n $$)",
            "רק איברי קוסינוס ($$ a_n $$)",
            "גם סינוסים וגם קוסינוסים",
            "רק את המקדם הקבוע $$ a_0 $$"
        ],
        correct: 0,
        explanation: "סינוס היא פונקציה אי-זוגית, ולכן סכום של סינוסים מתאים לייצוג פונקציה אי-זוגית. מקדמי הקוסינוס מתאפסים."
    },
    {
        q: "מהי תופעת גיבס (Gibbs Phenomenon)?",
        options: [
            "חריגה (Overshoot) של כ-9% בטור פורייה ליד נקודת אי-רציפות",
            "התכנסות מהירה של הטור לאפס",
            "שגיאה בחישוב המקדמים",
            "תופעה שבה הטור מתבדר לאינסוף"
        ],
        correct: 0,
        explanation: "גם אם לוקחים אינסוף איברים, בנקודת קפיצה (מדרגה) הטור תמיד 'יזרוק' חריגה קטנה לפני שהוא מתייצב."
    },
    {
        q: "תכונת האורתוגונליות: מהי תוצאת האינטגרל $$ \\int_{-\\pi}^{\\pi} \\sin(nx) \\cos(mx) dx $$?",
        options: [
            "0 (תמיד)",
            "$$ \\pi $$ אם $$ n=m $$",
            "$$ 2\\pi $$",
            "1"
        ],
        correct: 0,
        explanation: "סינוס וקוסינוס הם פונקציות אורתוגונליות. המכפלה שלהן (בכל תדר שלם) נותנת פונקציה שהשטח שלה מתאפס במחזור שלם."
    },
    {
        q: "משפט פרסבל (Parseval) בטורי פורייה מבטא את:",
        options: [
            "שימור האנרגיה: אנרגיה בזמן = סכום האנרגיות של המקדמים",
            "הקשר בין תדר לזמן מחזור",
            "התכנסות הטור בנקודות רציפות",
            "ליניאריות הטור"
        ],
        correct: 0,
        explanation: "המשפט קובע שהאינטגרל של ריבוע הפונקציה (אנרגיה) שווה לסכום ריבועי מקדמי פורייה שלה."
    },
    {
        q: "אם נמתח את הפונקציה בזמן פי 2 ($$ f(t) \\to f(t/2) $$), מה יקרה לסקאלת התדרים?",
        options: [
            "התדרים יתכווצו פי 2 (הגרף הספקטרלי נהיה צפוף יותר)",
            "התדרים יתכווצו פי 4",
            "התדרים יתרחבו פי 2",
            "לא יהיה שינוי בתדרים"
        ],
        correct: 0,
        explanation: "מתיחה בזמן שקולה לכיווץ בתדר. גל ארוך יותר בזמן הוא בעל תדר נמוך יותר."
    },
    {
        q: "מהם מקדמי פורייה של גל מרובע סימטרי סביב האפס?",
        options: [
            "דועכים כמו $$ 1/n $$ (רק אי-זוגיים)",
            "דועכים כמו $$ 1/n^2 $$",
            "קבועים לכל $$ n $$",
            "אפס כולם"
        ],
        correct: 0,
        explanation: "גל מרובע מכיל הרבה הרמוניות גבוהות שדועכות לאט יחסית ($$ 1/n $$), ולכן הוא נשמע 'חד' או 'מזמזם'."
    },

    // ============================================
    // חלק ג': התמרת פורייה (Fourier Transform)
    // ============================================
    {
        q: "התמרת פורייה של פונקציית דלתא $$ \\delta(t) $$ היא:",
        options: [
            "קבוע (1 לכל התדרים)",
            "פונקציית דלתא בתדר",
            "פונקציית גאוסיין",
            "פונקציית מדרגה"
        ],
        correct: 0,
        explanation: "פונקציית דלתא (הלם רגעי) מכילה את כל התדרים באותה עוצמה. זהו הבסיס לרעש לבן."
    },
    {
        q: "התמרת פורייה של גאוסיין $$ e^{-at^2} $$ היא:",
        options: [
            "גאוסיין נוסף (בתדר)",
            "פונקציית Lorentizan",
            "פונקציית Sinc",
            "פונקציית מלבן"
        ],
        correct: 0,
        explanation: "הגאוסיין הוא הפונקציה היחידה שצורתה נשמרת תחת התמרת פורייה. פולס גאוסי צר בזמן נותן גאוסיין רחב בתדר."
    },
    {
        q: "משפט הקונבולוציה (Convolution Theorem): התמרה של קונבולוציה בזמן $$ f(t) * g(t) $$ היא:",
        options: [
            "מכפלה רגילה בתדר $$ F(\\omega) \\cdot G(\\omega) $$",
            "קונבולוציה בתדר",
            "סכום בתדר",
            "חילוק בתדר"
        ],
        correct: 0,
        explanation: "זהו הכלי החזק ביותר בעיבוד אותות: פעולה מסובכת (קונבולוציה) הופכת לפעולה פשוטה (כפל) במרחב התדר."
    },
    {
        q: "מהי התמרת פורייה של פונקציית מלבן (Pulse)?",
        options: [
            "פונקציית $$ \\text{sinc}(\\omega) $$",
            "פונקציית מלבן רחבה יותר",
            "פונקציית משולש",
            "טור הנדסי"
        ],
        correct: 0,
        explanation: "פולס מוגבל בזמן יוצר ספקטרום אינסופי בצורת סינק, עם עליות וירידות צדדיות."
    },
    {
        q: "כיצד הזזה בזמן $$ f(t-t_0) $$ משפיעה על ההתמרה $$ F(\\omega) $$?",
        options: [
            "הכפלה בביטוי פאזה $$ e^{-i\\omega t_0} $$",
            "הזזה בתדר $$ F(\\omega - \\omega_0) $$",
            "אין שינוי כלל",
            "הכפלה בקבוע ממשי"
        ],
        correct: 0,
        explanation: "הזזה בזמן לא משנה את תוכן התדרים (האמפליטודה), אלא רק מסובבת את הפאזה של כל תדר."
    },
    {
        q: "עקרון האי-ודאות באותות קובע ש:",
        options: [
            "$$ \\Delta t \\cdot \\Delta \\omega \\ge \\text{const} $$",
            "$$ \\Delta t + \\Delta \\omega = 0 $$",
            "ניתן למדוד זמן ותדר בדיוק אינסופי בו זמנית",
            "רוחב הפס תמיד שווה לזמן המחזור"
        ],
        correct: 0,
        explanation: "לא ניתן ליצור אות שהוא גם קצר מאוד בזמן וגם צר מאוד בתדר. זהו עיקרון מתמטי של התמרת פורייה."
    },
    {
        q: "מהו ההבדל בין טור פורייה להתמרת פורייה?",
        options: [
            "טור מיועד לפונקציות מחזוריות, התמרה לפונקציות לא-מחזוריות (כלליות)",
            "טור משתמש במספרים מרוכבים, התמרה במספרים ממשים",
            "אין הבדל, אלו שמות נרדפים",
            "התמרה עובדת רק בזמן בדיד"
        ],
        correct: 0,
        explanation: "טור פורייה נותן ספקטרום בדיד (קווי), בעוד שהתמרת פורייה נותנת ספקטרום רציף."
    },

    // ============================================
    // חלק ד': נפיצה וחבילות גלים (Dispersion)
    // ============================================
    {
        q: "יחס נפיצה (Dispersion Relation) הוא הקשר בין:",
        options: [
            "$$ \\omega $$ ל-$$ k $$",
            "האנרגיה לתנע",
            "המקום לזמן",
            "המשרעת לתדר"
        ],
        correct: 0,
        explanation: "הפונקציה $$ \\omega(k) $$ קובעת את כל הפיזיקה של התפשטות הגל בתווך."
    },
    {
        q: "מה קורה לחבילת גלים בתווך דיספרסיבי (נפיץ) לאורך זמן?",
        options: [
            "היא נמרחת (מתרחבת) במרחב",
            "היא נשארת באותו רוחב בדיוק",
            "היא מתכווצת לנקודה",
            "היא משנה את צבעה לכחול"
        ],
        correct: 0,
        explanation: "מכיוון שכל תדר בחבילה נע במהירות שונה ($$ v_{phase} $$ שונה), החבילה מתפרקת ומתרחבת."
    },
    {
        q: "בגל מים עמוקים, יחס הנפיצה הוא $$ \\omega = \\sqrt{gk} $$. מהי מהירות החבורה?",
        options: [
            "$$ v_g = \\frac{1}{2} v_p $$",
            "$$ v_g = v_p $$",
            "$$ v_g = 2 v_p $$",
            "$$ v_g = 0 $$"
        ],
        correct: 0,
        explanation: "גזירה: $$ d\\omega/dk = \\frac{1}{2}\\sqrt{g/k} = \\frac{1}{2}(\\omega/k) = \\frac{1}{2}v_p $$. האנרגיה בים נעה בחצי ממהירות הגלים שאנו רואים."
    },
    {
        q: "מהירות פאזה יכולה להיות גדולה ממהירות האור $$ c $$?",
        options: [
            "כן, אך היא לא מעבירה מידע",
            "לא, זה סותר את היחסות",
            "רק בתוך חור שחור",
            "רק עבור גלי קול"
        ],
        correct: 0,
        explanation: "מהירות הפאזה היא מתמטית בלבד (נקודת חיתוך דמיונית). מהירות החבורה (האנרגיה/מידע) תמיד מוגבלת ל-$$ c $$."
    },
    {
        q: "תווך נקרא 'לא-דיספרסיבי' אם:",
        options: [
            "$$ \\omega $$ פרופורציונלי ליניארית ל-$$ k $$ ($$ \\omega = ck $$)",
            "$$ \\omega $$ תלוי ב-$$ k^2 $$",
            "המקדם $$ n $$ תלוי באורך הגל",
            "יש בו חיכוך"
        ],
        correct: 0,
        explanation: "במצב זה $$ v_p = v_g = c $$ קבוע, וכל הגלים נעים יחד ללא עיוות (כמו במיתר אידיאלי או בריק)."
    },
    {
        q: "תופעת ה-Cutoff במוביל גלים (Waveguide) משמעותה:",
        options: [
            "תדרים מתחת לערך מסוים דועכים אקספוננציאלית ולא מתקדמים",
            "הגל נחתך לחלקים",
            "המהירות הופכת לאינסופית",
            "הגל הופך לגל עומד בלבד"
        ],
        correct: 0,
        explanation: "עבור תדרים נמוכים, $$ k $$ הופך למדומה ($$ k = \\sqrt{\\omega^2 - \\omega_c^2} $$), מה שמוביל לדעיכה במקום להתפשטות."
    },

    // ============================================
    // חלק ה': גלים בדו-מימד (ממברנות)
    // ============================================
    {
        q: "משוואת הגלים בדו-מימד מערבת את האופרטור:",
        options: [
            "לפלסיאן ב-2D ($$ \\nabla^2 = \\partial_{xx} + \\partial_{yy} $$)",
            "גרדיאנט",
            "רוטור (Curl)",
            "נגזרת שלישית"
        ],
        correct: 0,
        explanation: "הכוח המשיב בממברנה (כמו תוף) נובע מהקעירות שלה בשני הכיוונים."
    },
    {
        q: "בממברנה מלבנית, אופני התנודה (Modas) תלויים ב:",
        options: [
            "שני מספרים שלמים ($$ n, m $$)",
            "מספר שלם אחד ($$ n $$)",
            "שלושה מספרים",
            "רדיוס הממברנה"
        ],
        correct: 0,
        explanation: "כמו במיתר שיש לו $$ n $$, במלבן יש הרמוניות לאורך ($$ n $$) ולרוחב ($$ m $$)."
    },
    {
        q: "מהם קווי צומת (Nodal Lines) בממברנה רוטטת?",
        options: [
            "קווים על הממברנה שאינם זזים כלל במהלך התנודה",
            "הקווים שבהם המהירות מקסימלית",
            "הקצוות של הממברנה בלבד",
            "קווים שבהם הממברנה נקרעת"
        ],
        correct: 0,
        explanation: "בניגוד למיתר שיש לו נקודות צומת, בדו-מימד האזורים הנייחים יוצרים צורות גיאומטריות (קווים, מעגלים)."
    },
    {
        q: "בפתרון משוואת הגלים בקואורדינטות פולריות (תוף עגול), החלק הרדיאלי מתואר ע\"י:",
        options: [
            "פונקציות בסל (Bessel Functions)",
            "פונקציות סינוס וקוסינוס",
            "פולינומי לג'נדר",
            "פונקציות גאוס"
        ],
        correct: 0,
        explanation: "פונקציות בסל ($$ J_n(r) $$) הן הפתרון הטבעי לבעיות גלים בסימטריה גלילית/מעגלית."
    },
    {
        q: "מהי 'ניוון' (Degeneracy) באופני תנודה של ממברנה רבועית?",
        options: [
            "שני אופני תנודה שונים (למשל 1,2 ו-2,1) בעלי אותו תדר בדיוק",
            "מצב בו הממברנה מפסיקה לרטוט",
            "כאשר התדר שווה לאפס",
            "כאשר יש רק אופן תנודה אחד"
        ],
        correct: 0,
        explanation: "בגלל הסימטריה, האופן שבו יש גבעה אחת ב-x ושתיים ב-y זהה באנרגיה לאופן ההפוך."
    },
    {
        q: "צורות קלאדני (Chladni Figures) נוצרות כאשר:",
        options: [
            "מפזרים חול על משטח רוטט והחול מצטבר בקווי הצומת",
            "מאירים בלייזר על מיתר",
            "מנגנים בכינור במים",
            "מחממים את הממברנה"
        ],
        correct: 0,
        explanation: "החול 'בורח' מהאזורים הרועדים (Antinodes) ונח באזורים השקטים (Nodes), מה שחושף ויזואלית את אופן התנודה."
    },

    // ============================================
    // חלק ו': שאלות בונוס מתקדמות (אנרגיה ומדידה)
    // ============================================
    {
        q: "עכבה אופיינית (Impedance) של מיתר מוגדרת כ:",
        options: [
            "$$ Z = \\sqrt{T \\mu} $$",
            "$$ Z = T / \\mu $$",
            "$$ Z = \\mu c^2 $$",
            "$$ Z = 1/c $$"
        ],
        correct: 0,
        explanation: "העכבה קובעת כמה קשה ליצור גל במיתר ומשפיעה על מקדמי ההחזרה וההעברה בחיבור בין מיתרים."
    },
    {
        q: "במעבר גל ממיתר קל למיתר כבד, הגל המוחזר:",
        options: [
            "הופך פאזה (כמו פגיעה בקיר)",
            "שומר על הפאזה",
            "מתאפס",
            "הופך לגל עומד"
        ],
        correct: 0,
        explanation: "מיתר כבד מתנהג כמו 'קיר' חלקי עבור המיתר הקל, ולכן יש היפוך פאזה חלקי."
    },
    {
        q: "מהירות הקול באוויר תלויה בטמפרטורה ($$ T $$) לפי:",
        options: [
            "$$ \\sqrt{T} $$",
            "$$ T $$",
            "$$ 1/T $$",
            "$$ T^2 $$"
        ],
        correct: 0,
        explanation: "ככל שהטמפרטורה עולה, המולקולות זזות מהר יותר והגל מתקדם מהר יותר."
    },
    {
        q: "איזה סוג של גל הוא גל קול באוויר?",
        options: [
            "גל אורכי (Longitudinal) - הפרעות לחץ",
            "גל רוחבי (Transverse)",
            "גל אלקטרומגנטי",
            "גל עומד בלבד"
        ],
        correct: 0,
        explanation: "באוויר (גז), אין כוחות גזירה, ולכן החלקיקים יכולים לזוז רק קדימה ואחורה בכיוון התקדמות הגל."
    },
    {
        q: "אפקט דופלר: משוואת התדר הנקלט כאשר המקור והצופה מתקרבים זה לזה:",
        options: [
            "$$ f' = f \\frac{c+v_o}{c-v_s} $$",
            "$$ f' = f \\frac{c-v_o}{c+v_s} $$",
            "$$ f' = f (1 + v/c) $$",
            "$$ f' = f $$"
        ],
        correct: 0,
        explanation: "שני הגורמים תורמים לעליית התדר: הצופה 'אוסף' גלים מהר יותר, והמקור 'דוחס' את הגלים."
    },
    {
        q: "הספק (Power) המועבר על ידי גל במיתר פרופורציונלי ל:",
        options: [
            "$$ A^2 \\omega^2 c $$",
            "$$ A \\omega $$",
            "$$ A^2 / \\omega $$",
            "$$ c^2 $$ בלבד"
        ],
        correct: 0,
        explanation: "הספק הוא קצב העברת האנרגיה. הוא תלוי בריבוע המשרעת, ריבוע התדר, ומהירות הגל."
    },
    {
        q: "משוואת הטלגרף (Telegrapher's Equation) מוסיפה למשוואת הגלים איבר של:",
        options: [
            "נגזרת ראשונה בזמן (דעיכה/חיכוך)",
            "נגזרת שלישית במקום",
            "איבר לא ליניארי",
            "פונקציית סינוס"
        ],
        correct: 0,
        explanation: "האיבר $$ \\gamma u_t $$ מייצג איבוד אנרגיה (התנגדות במעגל חשמלי או חיכוך במיתר)."
    },
    {
        q: "מהו 'אורך קוהרנטיות'?",
        options: [
            "המרחק שבו הגל שומר על יחסי פאזה קבועים",
            "אורך הגל הממוצע",
            "המרחק בין שני מקורות",
            "עובי העדשה"
        ],
        correct: 0,
        explanation: "זהו מדד לכמה 'טהור' הגל. ללייזר יש אורך קוהרנטיות גדול, לנורה רגילה - מיקרונים בודדים."
    },
    {
        q: "פונקציית התמסורת (Transfer Function) של מערכת ליניארית היא:",
        options: [
            "התמרת פורייה של התגובה להלם (Impulse Response)",
            "התגובה למדרגה",
            "היחס בין המשרעת לאורך הגל",
            "השורש של אות הכניסה"
        ],
        correct: 0,
        explanation: "אם יודעים איך המערכת מגיבה להלם ($$ h(t) $$), יודעים איך היא מגיבה לכל תדר ($$ H(\\omega) $$)."
    },
    {
        q: "בגלים אלקטרומגנטיים, הווקטור המגנטי $$ B $$ והחשמלי $$ E $$ הם:",
        options: [
            "באותה פאזה (בריק)",
            "בהפרש פאזה של 90 מעלות",
            "בהפרש פאזה של 180 מעלות",
            "לא קשורים בפאזה"
        ],
        correct: 0,
        explanation: "בגל מישורי חופשי, השיאים של השדה החשמלי והמגנטי מגיעים יחד לאותה נקודה."
    },
    {
        q: "קיטוב אליפטי נוצר כאשר:",
        options: [
            "יש הפרש פאזה שונה מ-0 ומ-90, או משרעות שונות ב-90 מעלות",
            "הפרש הפאזה הוא 0 בדיוק",
            "המשרעות שוות וההפרש הוא 0",
            "רק בלייזרים"
        ],
        correct: 0,
        explanation: "זהו המקרה הכללי ביותר של קיטוב. מעגלי וליניארי הם מקרים פרטיים שלו."
    }
];

    // --- לוגיקת משחק ---
    let currentQIndex = 0;
    let score = 0;
    let isAnswered = false;

    const elQText = document.getElementById("question-text");
    const elOptions = document.getElementById("options-container");
    const elScore = document.getElementById("score");
    const elQCurr = document.getElementById("q-curr");
    const elQTotal = document.getElementById("q-total");
    const elFeedback = document.getElementById("feedback");
    const elFbTitle = document.getElementById("fb-title");
    const elFbText = document.getElementById("fb-text");
    const elNextBtn = document.getElementById("next-btn");

   function initGame() {
        // ערבוב רנדומלי של סדר השאלות
        questions.sort(() => Math.random() - 0.5);
        
        // איפוס המונים למקרה של משחק חוזר
        currentQIndex = 0;
        score = 0;
        document.getElementById("score").innerText = "0";

        // עדכון סך השאלות בתצוגה
        elQTotal.innerText = questions.length;
        
        // טעינת השאלה הראשונה (אחרי הערבוב)
        loadQuestion();
        drawParticles(); 
    }

    function loadQuestion() {
        const qData = questions[currentQIndex];
        isAnswered = false;
        
        // UI Reset
        elFeedback.style.display = "none";
        elNextBtn.style.display = "none";
        elQText.innerHTML = qData.q;
        elQCurr.innerText = currentQIndex + 1;
        elOptions.innerHTML = "";

        // יצירת כפתורים
        qData.options.forEach((opt, index) => {
            const btn = document.createElement("button");
            btn.className = "option-btn";
            btn.innerHTML = opt; // שימוש ב-innerHTML כדי לתמוך ב-Latex
            btn.onclick = () => checkAnswer(index, btn);
            elOptions.appendChild(btn);
        });

        // רענון MathJax (קריטי להצגת נוסחאות חדשות)
        if (window.MathJax) {
            MathJax.typesetPromise();
        }
    }

    function checkAnswer(selectedIndex, btnElement) {
        if (isAnswered) return;
        isAnswered = true;

        const qData = questions[currentQIndex];
        const buttons = elOptions.querySelectorAll(".option-btn");

        // סימון ויזואלי
        if (selectedIndex === qData.correct) {
            btnElement.classList.add("correct");
            score += 10;
            elScore.innerText = score;
            elFbTitle.innerText = "✨ תשובה נכונה!";
            elFbTitle.style.color = "var(--correct)";
            triggerConfetti(btnElement.getBoundingClientRect()); // אפקט קטן
        } else {
            btnElement.classList.add("wrong");
            buttons[qData.correct].classList.add("correct"); // מראה את התשובה הנכונה
            elFbTitle.innerText = "❌ לא נכון...";
            elFbTitle.style.color = "var(--wrong)";
        }

        // הצגת הסבר
        elFbText.innerHTML = qData.explanation;
        elFeedback.style.display = "block";
        elNextBtn.style.display = "block";

        // רענון נוסחאות בהסבר
        if (window.MathJax) {
            MathJax.typesetPromise([elFeedback]);
        }
    }

    function nextQuestion() {
        currentQIndex++;
        if (currentQIndex < questions.length) {
            loadQuestion();
        } else {
            endGame();
        }
    }

    function endGame() {
        document.getElementById("quiz-container").style.display = "none";
        const finCard = document.getElementById("finish-card");
        finCard.style.display = "block";
        document.getElementById("final-score").innerText = score;
        document.getElementById("max-score").innerText = questions.length * 10;
        
        let msg = "נסה שוב!";
        if(score > questions.length * 5) msg = "יפה מאוד!";
        if(score === questions.length * 10) msg = "גאון פיזיקה! 🚀";
        document.getElementById("finish-msg").innerText = msg;
        
        // חגיגת סיום
        setInterval(() => {
            triggerConfetti({left: window.innerWidth/2, top: window.innerHeight/2, width:0});
        }, 300);
    }

    // --- אפקטים גראפיים (חלקיקים רקע) ---
    function drawParticles() {
        const canvas = document.getElementById("particles");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const particles = [];
        for(let i=0; i<50; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                r: Math.random() * 2 + 1,
                d: Math.random() * 200 // צפיפות
            });
        }

        function animate() {
            ctx.clearRect(0,0, canvas.width, canvas.height);
            ctx.fillStyle = "rgba(139, 92, 246, 0.3)"; // סגול חלש
            
            particles.forEach(p => {
                p.y -= 0.5; // תנועה למעלה
                if(p.y < 0) p.y = canvas.height;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
                ctx.fill();
            });
            requestAnimationFrame(animate);
        }
        animate();
    }
    
    // מיני-מנוע קונפטי פשוט ללא ספריות חיצוניות
    function triggerConfetti(rect) {
        const colors = ['#f43f5e', '#10b981', '#3b82f6', '#f59e0b', '#8b5cf6'];
        const count = 30;
        const originX = rect.left + rect.width / 2;
        const originY = rect.top;

        for (let i = 0; i < count; i++) {
            const el = document.createElement('div');
            el.style.position = 'fixed';
            el.style.left = originX + 'px';
            el.style.top = originY + 'px';
            el.style.width = '8px';
            el.style.height = '8px';
            el.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            el.style.borderRadius = '50%';
            el.style.pointerEvents = 'none';
            el.style.zIndex = '1000';
            document.body.appendChild(el);

            // אנימציה
            const angle = Math.random() * Math.PI * 2;
            const velocity = 2 + Math.random() * 4;
            let x = 0, y = 0;
            let vx = Math.cos(angle) * velocity;
            let vy = Math.sin(angle) * velocity;
            let opacity = 1;

            const anim = setInterval(() => {
                x += vx;
                y += vy;
                vy += 0.2; // כבידה
                opacity -= 0.02;
                
                el.style.transform = `translate(${x}px, ${y}px)`;
                el.style.opacity = opacity;

                if (opacity <= 0) {
                    clearInterval(anim);
                    el.remove();
                }
            }, 16);
        }
    }

    // התחלה
    initGame();

</script>
</body>
</html>